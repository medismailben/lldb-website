<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="LLDB Python API" href="../python_api.html" /><link rel="prev" title="Python Scripting" href="python.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.07.26 -->
        <title>Python Reference - üêõ LLDB</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/lldb.css?v=ac31cab2" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">üêõ LLDB</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">üêõ LLDB</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Using LLDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="map.html">GDB to LLDB command map</a></li>
<li class="toctree-l1"><a class="reference internal" href="formatting.html">Frame and Thread Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variable Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="symbolication.html">Symbolication</a></li>
<li class="toctree-l1"><a class="reference internal" href="symbols.html">Symbols on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">DWARF Extensions supported by LLDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote.html">Remote Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="qemu-testing.html">Testing LLDB using QEMU</a></li>
<li class="toctree-l1"><a class="reference internal" href="intel_pt.html">Tracing with Intel Processor Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="ondemand.html">On Demand Symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../man/lldb.html">Man Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extending LLDB</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Scripting</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Python Reference</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python_api.html">Python API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Python API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBAddress.html">SBAddress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBAttachInfo.html">SBAttachInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBBlock.html">SBBlock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBBreakpoint.html">SBBreakpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBBreakpointList.html">SBBreakpointList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBBreakpointLocation.html">SBBreakpointLocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBBreakpointName.html">SBBreakpointName</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBBroadcaster.html">SBBroadcaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBCommandInterpreter.html">SBCommandInterpreter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBCommandInterpreterRunOptions.html">SBCommandInterpreterRunOptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBCommandReturnObject.html">SBCommandReturnObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBCommunication.html">SBCommunication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBCompileUnit.html">SBCompileUnit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBData.html">SBData</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBDebugger.html">SBDebugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBDeclaration.html">SBDeclaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBEnvironment.html">SBEnvironment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBError.html">SBError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBEvent.html">SBEvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBExecutionContext.html">SBExecutionContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBExpressionOptions.html">SBExpressionOptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBFile.html">SBFile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBFileSpec.html">SBFileSpec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBFileSpecList.html">SBFileSpecList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBFrame.html">SBFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBFunction.html">SBFunction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBHostOS.html">SBHostOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBInstruction.html">SBInstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBInstructionList.html">SBInstructionList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBLanguageRuntime.html">SBLanguageRuntime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBLaunchInfo.html">SBLaunchInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBLineEntry.html">SBLineEntry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBListener.html">SBListener</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBMemoryRegionInfo.html">SBMemoryRegionInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBMemoryRegionInfoList.html">SBMemoryRegionInfoList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBModule.html">SBModule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBModuleSpec.html">SBModuleSpec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBModuleSpecList.html">SBModuleSpecList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBPlatform.html">SBPlatform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBPlatformConnectOptions.html">SBPlatformConnectOptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBPlatformShellCommand.html">SBPlatformShellCommand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBProcess.html">SBProcess</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBProcessInfo.html">SBProcessInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBQueue.html">SBQueue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBQueueItem.html">SBQueueItem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBReproducer.html">SBReproducer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBScriptObject.html">SBScriptObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBSection.html">SBSection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBSourceManager.html">SBSourceManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBStream.html">SBStream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBStringList.html">SBStringList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBStructuredData.html">SBStructuredData</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBSymbol.html">SBSymbol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBSymbolContext.html">SBSymbolContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBSymbolContextList.html">SBSymbolContextList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBSyntheticValueProvider.html">SBSyntheticValueProvider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTarget.html">SBTarget</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBThread.html">SBThread</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBThreadCollection.html">SBThreadCollection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBThreadPlan.html">SBThreadPlan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTrace.html">SBTrace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTraceCursor.html">SBTraceCursor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBType.html">SBType</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeCategory.html">SBTypeCategory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeEnumMember.html">SBTypeEnumMember</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeEnumMemberList.html">SBTypeEnumMemberList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeFilter.html">SBTypeFilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeFormat.html">SBTypeFormat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeList.html">SBTypeList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeMember.html">SBTypeMember</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeMemberFunction.html">SBTypeMemberFunction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeNameSpecifier.html">SBTypeNameSpecifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeSummary.html">SBTypeSummary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeSummaryOptions.html">SBTypeSummaryOptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBTypeSynthetic.html">SBTypeSynthetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBUnixSignals.html">SBUnixSignals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBValue.html">SBValue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBValueList.html">SBValueList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBVariablesOptions.html">SBVariablesOptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.SBWatchpoint.html">SBWatchpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.declaration.html">declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.value.html">value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/lldb.value_iter.html">value_iter</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developing LLDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resources/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/build.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/test.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/fuzzing.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/bots.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/caveats.html">Caveats</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/namespacelldb.html">Public C++ API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/index.html">Private C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://reviews.llvm.org">Code Reviews</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/issues/labels/lldb/">Bug Reports</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="python-reference">
<h1>Python Reference<a class="headerlink" href="#python-reference" title="Permalink to this heading">#</a></h1>
<p>The entire LLDB API is available as Python functions through a script bridging
interface. This means the LLDB API‚Äôs can be used directly from python either
interactively or to build python apps that provide debugger features.</p>
<p>Additionally, Python can be used as a programmatic interface within the lldb
command interpreter (we refer to this for brevity as the embedded interpreter).
Of course, in this context it has full access to the LLDB API - with some
additional conveniences we will call out in the FAQ.</p>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">#</a></h2>
<p>The LLDB API is contained in a python module named lldb. A useful resource when
writing Python extensions is the lldb Python classes reference guide.</p>
<p>The documentation is also accessible in an interactive debugger session with
the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">script</span> <span class="n">help</span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span>
   <span class="n">Help</span> <span class="n">on</span> <span class="n">package</span> <span class="n">lldb</span><span class="p">:</span>

   <span class="n">NAME</span>
      <span class="n">lldb</span> <span class="o">-</span> <span class="n">The</span> <span class="n">lldb</span> <span class="n">module</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">public</span> <span class="n">APIs</span> <span class="k">for</span> <span class="n">Python</span> <span class="n">binding</span><span class="o">.</span>

   <span class="n">FILE</span>
      <span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">PrivateFrameworks</span><span class="o">/</span><span class="n">LLDB</span><span class="o">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="n">lldb</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>

   <span class="n">DESCRIPTION</span>
<span class="o">...</span>
</pre></div>
</div>
<p>You can also get help using a module class name. The full API that is exposed
for that class will be displayed in a man page style window. Below we want to
get help on the lldb.SBFrame class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">script</span> <span class="n">help</span><span class="p">(</span><span class="n">lldb</span><span class="o">.</span><span class="n">SBFrame</span><span class="p">)</span>
   <span class="n">Help</span> <span class="n">on</span> <span class="k">class</span> <span class="nc">SBFrame</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">lldb</span><span class="p">:</span>

   <span class="k">class</span> <span class="nc">SBFrame</span><span class="p">(</span><span class="n">__builtin__</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
   <span class="o">|</span>  <span class="n">Represents</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">stack</span> <span class="n">frames</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">a</span> <span class="n">thread</span><span class="o">.</span>
   <span class="o">|</span>  <span class="n">SBThread</span> <span class="n">contains</span> <span class="n">SBFrame</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">For</span> <span class="n">example</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">test</span><span class="o">/</span><span class="n">lldbutil</span><span class="o">.</span><span class="n">py</span><span class="p">),</span>
   <span class="o">|</span>
   <span class="o">|</span>  <span class="k">def</span> <span class="nf">print_stacktrace</span><span class="p">(</span><span class="n">thread</span><span class="p">,</span> <span class="n">string_buffer</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
   <span class="o">|</span>      <span class="s1">&#39;&#39;&#39;Prints a simple stack trace of this thread.&#39;&#39;&#39;</span>
   <span class="o">|</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Or you can get help using any python object, here we use the lldb.process
object which is a global variable in the lldb module which represents the
currently selected process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">script</span> <span class="n">help</span><span class="p">(</span><span class="n">lldb</span><span class="o">.</span><span class="n">process</span><span class="p">)</span>
   <span class="n">Help</span> <span class="n">on</span> <span class="n">SBProcess</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">lldb</span> <span class="nb">object</span><span class="p">:</span>

   <span class="k">class</span> <span class="nc">SBProcess</span><span class="p">(</span><span class="n">__builtin__</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
   <span class="o">|</span>  <span class="n">Represents</span> <span class="n">the</span> <span class="n">process</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">target</span> <span class="n">program</span><span class="o">.</span>
   <span class="o">|</span>
   <span class="o">|</span>  <span class="n">SBProcess</span> <span class="n">supports</span> <span class="n">thread</span> <span class="n">iteration</span><span class="o">.</span> <span class="n">For</span> <span class="n">example</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">test</span><span class="o">/</span><span class="n">lldbutil</span><span class="o">.</span><span class="n">py</span><span class="p">),</span>
   <span class="o">|</span>
   <span class="o">|</span>  <span class="c1"># ==================================================</span>
   <span class="o">|</span>  <span class="c1"># Utility functions related to Threads and Processes</span>
   <span class="o">|</span>  <span class="c1"># ==================================================</span>
   <span class="o">|</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="embedded-python-interpreter">
<h2>Embedded Python Interpreter<a class="headerlink" href="#embedded-python-interpreter" title="Permalink to this heading">#</a></h2>
<p>The embedded python interpreter can be accessed in a variety of ways from
within LLDB. The easiest way is to use the lldb command script with no
arguments at the lldb command prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">script</span>
<span class="n">Python</span> <span class="n">Interactive</span> <span class="n">Interpreter</span><span class="o">.</span> <span class="n">To</span> <span class="n">exit</span><span class="p">,</span> <span class="nb">type</span> <span class="s1">&#39;quit()&#39;</span><span class="p">,</span> <span class="s1">&#39;exit()&#39;</span> <span class="ow">or</span> <span class="n">Ctrl</span><span class="o">-</span><span class="n">D</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">+</span><span class="mi">3</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">hex</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="s1">&#39;0x3039&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>This drops you into the embedded python interpreter. When running under the
script command, lldb sets some convenience variables that give you quick access
to the currently selected entities that characterize the program and debugger
state. In each case, if there is no currently selected entity of the
appropriate type, the variable‚Äôs IsValid method will return false. These
variables are:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Variable</p></td>
<td><p>Type</p></td>
<td><p>Equivalent</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lldb.debugger</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBDebugger.html#lldb.SBDebugger" title="lldb.SBDebugger"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBDebugger</span></code></a></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBTarget.html#lldb.SBTarget.GetDebugger" title="lldb.SBTarget.GetDebugger"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBTarget.GetDebugger</span></code></a></p></td>
<td><p>Contains the debugger object whose <code class="docutils literal notranslate"><span class="pre">script</span></code> command was invoked.
The <a class="reference internal" href="../python_api/lldb.SBDebugger.html#lldb.SBDebugger" title="lldb.SBDebugger"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBDebugger</span></code></a> object owns the command interpreter
and all the targets in your debug session.  There will always be a
Debugger in the embedded interpreter.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lldb.target</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBTarget.html#lldb.SBTarget" title="lldb.SBTarget"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBTarget</span></code></a></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBDebugger.html#lldb.SBDebugger.GetSelectedTarget" title="lldb.SBDebugger.GetSelectedTarget"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBDebugger.GetSelectedTarget</span></code></a></p>
<p><a class="reference internal" href="../python_api/lldb.SBProcess.html#lldb.SBProcess.GetTarget" title="lldb.SBProcess.GetTarget"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBProcess.GetTarget</span></code></a></p>
</td>
<td><p>Contains the currently selected target - for instance the one made with the
<code class="docutils literal notranslate"><span class="pre">file</span></code> or selected by the <code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">select</span> <span class="pre">&lt;target-index&gt;</span></code> command.
The <a class="reference internal" href="../python_api/lldb.SBTarget.html#lldb.SBTarget" title="lldb.SBTarget"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBTarget</span></code></a> manages one running process, and all the executable
and debug files for the process.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lldb.process</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBProcess.html#lldb.SBProcess" title="lldb.SBProcess"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBProcess</span></code></a></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBTarget.html#lldb.SBTarget.GetProcess" title="lldb.SBTarget.GetProcess"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBTarget.GetProcess</span></code></a></p>
<p><a class="reference internal" href="../python_api/lldb.SBThread.html#lldb.SBThread.GetProcess" title="lldb.SBThread.GetProcess"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBThread.GetProcess</span></code></a></p>
</td>
<td><p>Contains the process of the currently selected target.
The <a class="reference internal" href="../python_api/lldb.SBProcess.html#lldb.SBProcess" title="lldb.SBProcess"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBProcess</span></code></a> object manages the threads and allows access to
memory for the process.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lldb.thread</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBThread.html#lldb.SBThread" title="lldb.SBThread"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBThread</span></code></a></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBProcess.html#lldb.SBProcess.GetSelectedThread" title="lldb.SBProcess.GetSelectedThread"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBProcess.GetSelectedThread</span></code></a></p>
<p><a class="reference internal" href="../python_api/lldb.SBFrame.html#lldb.SBFrame.GetThread" title="lldb.SBFrame.GetThread"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBFrame.GetThread</span></code></a></p>
</td>
<td><p>Contains the currently selected thread.
The <a class="reference internal" href="../python_api/lldb.SBThread.html#lldb.SBThread" title="lldb.SBThread"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBThread</span></code></a> object manages the stack frames in that thread.
A thread is always selected in the command interpreter when a target stops.
The <code class="docutils literal notranslate"><span class="pre">thread</span> <span class="pre">select</span> <span class="pre">&lt;thread-index&gt;</span></code> command can be used to change the
currently selected thread.  So as long as you have a stopped process, there will be
some selected thread.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lldb.frame</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBFrame.html#lldb.SBFrame" title="lldb.SBFrame"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBFrame</span></code></a></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBThread.html#lldb.SBThread.GetSelectedFrame" title="lldb.SBThread.GetSelectedFrame"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBThread.GetSelectedFrame</span></code></a></p></td>
<td><p>Contains the currently selected stack frame.
The <a class="reference internal" href="../python_api/lldb.SBFrame.html#lldb.SBFrame" title="lldb.SBFrame"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBFrame</span></code></a> object manage the stack locals and the register set for
that stack.
A stack frame is always selected in the command interpreter when a target stops.
The <code class="docutils literal notranslate"><span class="pre">frame</span> <span class="pre">select</span> <span class="pre">&lt;frame-index&gt;</span></code> command can be used to change the
currently selected frame.  So as long as you have a stopped process, there will
be some selected frame.</p></td>
</tr>
</tbody>
</table>
</div>
<p>While extremely convenient, these variables have a couple caveats that you
should be aware of. First of all, they hold the values of the selected objects
on entry to the embedded interpreter. They do not update as you use the LLDB
API‚Äôs to change, for example, the currently selected stack frame or thread.</p>
<p>Moreover, they are only defined and meaningful while in the interactive Python
interpreter. There is no guarantee on their value in any other situation, hence
you should not use them when defining Python formatters, breakpoint scripts and
commands (or any other Python extension point that LLDB provides). For the
latter you‚Äôll be passed an <a class="reference internal" href="../python_api/lldb.SBDebugger.html#lldb.SBDebugger" title="lldb.SBDebugger"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBDebugger</span></code></a>, <a class="reference internal" href="../python_api/lldb.SBTarget.html#lldb.SBTarget" title="lldb.SBTarget"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBTarget</span></code></a>, <a class="reference internal" href="../python_api/lldb.SBProcess.html#lldb.SBProcess" title="lldb.SBProcess"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBProcess</span></code></a>, <a class="reference internal" href="../python_api/lldb.SBThread.html#lldb.SBThread" title="lldb.SBThread"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBThread</span></code></a> or
<a class="reference internal" href="../python_api/lldb.SBFrame.html#lldb.SBFrame" title="lldb.SBFrame"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBFrame</span></code></a> instance and you can use the functions from the ‚ÄúEquivalent‚Äù column
to navigate between them.</p>
<p>As a rationale for such behavior, consider that lldb can run in a multithreaded
environment, and another thread might call the ‚Äúscript‚Äù command, changing the
value out from under you.</p>
<p>To get started with these objects and LLDB scripting, please note that almost
all of the lldb Python objects are able to briefly describe themselves when you
pass them to the Python print function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">script</span>
<span class="n">Python</span> <span class="n">Interactive</span> <span class="n">Interpreter</span><span class="o">.</span> <span class="n">To</span> <span class="n">exit</span><span class="p">,</span> <span class="nb">type</span> <span class="s1">&#39;quit()&#39;</span><span class="p">,</span> <span class="s1">&#39;exit()&#39;</span> <span class="ow">or</span> <span class="n">Ctrl</span><span class="o">-</span><span class="n">D</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">lldb</span><span class="o">.</span><span class="n">debugger</span>
<span class="n">Debugger</span> <span class="p">(</span><span class="n">instance</span><span class="p">:</span> <span class="s2">&quot;debugger_1&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">lldb</span><span class="o">.</span><span class="n">target</span>
<span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">lldb</span><span class="o">.</span><span class="n">process</span>
<span class="n">SBProcess</span><span class="p">:</span> <span class="n">pid</span> <span class="o">=</span> <span class="mi">59289</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">stopped</span><span class="p">,</span> <span class="n">threads</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">executable</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">lldb</span><span class="o">.</span><span class="n">thread</span>
<span class="n">SBThread</span><span class="p">:</span> <span class="n">tid</span> <span class="o">=</span> <span class="mh">0x1f03</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">lldb</span><span class="o">.</span><span class="n">frame</span>
<span class="n">frame</span> <span class="c1">#0: 0x0000000100000bb6 a.out main + 54 at main.c:16</span>
</pre></div>
</div>
</section>
<section id="running-a-python-script-when-a-breakpoint-gets-hit">
<h2>Running a python script when a breakpoint gets hit<a class="headerlink" href="#running-a-python-script-when-a-breakpoint-gets-hit" title="Permalink to this heading">#</a></h2>
<p>One very powerful use of the lldb Python API is to have a python script run
when a breakpoint gets hit. Adding python scripts to breakpoints provides a way
to create complex breakpoint conditions and also allows for smart logging and
data gathering.</p>
<p>When your process hits a breakpoint to which you have attached some python
code, the code is executed as the body of a function which takes three
arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">breakpoint_function_wrapper</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">bp_loc</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
   <span class="c1"># Your code goes here</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">breakpoint_function_wrapper</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">bp_loc</span><span class="p">,</span> <span class="n">extra_args</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
   <span class="c1"># Your code goes here</span>
</pre></div>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Argument</p></td>
<td><p>Type</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">frame</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBFrame.html#lldb.SBFrame" title="lldb.SBFrame"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBFrame</span></code></a></p></td>
<td><p>The current stack frame where the breakpoint got hit.
The object will always be valid.
This <code class="docutils literal notranslate"><span class="pre">frame</span></code> argument might <em>not</em> match the currently selected stack frame found in the <a class="reference internal" href="../python_api.html#module-lldb" title="lldb"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">lldb</span></code></a> module global variable <code class="docutils literal notranslate"><span class="pre">lldb.frame</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bp_loc</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBBreakpointLocation.html#lldb.SBBreakpointLocation" title="lldb.SBBreakpointLocation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBBreakpointLocation</span></code></a></p></td>
<td><p>The breakpoint location that just got hit. Breakpoints are represented by <a class="reference internal" href="../python_api/lldb.SBBreakpoint.html#lldb.SBBreakpoint" title="lldb.SBBreakpoint"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBBreakpoint</span></code></a>
objects. These breakpoint objects can have one or more locations. These locations
are represented by <a class="reference internal" href="../python_api/lldb.SBBreakpointLocation.html#lldb.SBBreakpointLocation" title="lldb.SBBreakpointLocation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBBreakpointLocation</span></code></a> objects.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extra_args</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBStructuredData.html#lldb.SBStructuredData" title="lldb.SBStructuredData"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBStructuredData</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Optional</span></code> If your breakpoint callback function takes this extra parameter, then when the callback gets added to a breakpoint, its
contents can parametrize this use of the callback.  For instance, instead of writing a callback that stops when the caller is ‚ÄúFoo‚Äù,
you could take the function name from a field in the <code class="docutils literal notranslate"><span class="pre">extra_args</span></code>, making the callback more general.  The <code class="docutils literal notranslate"><span class="pre">-k</span></code> and <code class="docutils literal notranslate"><span class="pre">-v</span></code> options
to <code class="docutils literal notranslate"><span class="pre">breakpoint</span> <span class="pre">command</span> <span class="pre">add</span></code> will be passed as a Dictionary in the <code class="docutils literal notranslate"><span class="pre">extra_args</span></code> parameter, or you can provide it with the SB API‚Äôs.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">internal_dict</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td><p>The python session dictionary as a standard python dictionary object.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Optionally, a Python breakpoint command can return a value. Returning False
tells LLDB that you do not want to stop at the breakpoint. Any other return
value (including None or leaving out the return statement altogether) is akin
to telling LLDB to actually stop at the breakpoint. This can be useful in
situations where a breakpoint only needs to stop the process when certain
conditions are met, and you do not want to inspect the program state manually
at every stop and then continue.</p>
<p>An example will show how simple it is to write some python code and attach it
to a breakpoint. The following example will allow you to track the order in
which the functions in a given shared library are first executed during one run
of your program. This is a simple method to gather an order file which can be
used to optimize function placement within a binary for execution locality.</p>
<p>We do this by setting a regular expression breakpoint that will match every
function in the shared library. The regular expression ‚Äò.‚Äô will match any
string that has at least one character in it, so we will use that. This will
result in one lldb.SBBreakpoint object that contains an
lldb.SBBreakpointLocation object for each function. As the breakpoint gets hit,
we use a counter to track the order in which the function at this particular
breakpoint location got hit. Since our code is passed the location that was
hit, we can get the name of the function from the location, disable the
location so we won‚Äôt count this function again; then log some info and continue
the process.</p>
<p>Note we also have to initialize our counter, which we do with the simple
one-line version of the script command.</p>
<p>Here is the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="nb">breakpoint</span> <span class="nb">set</span> <span class="o">--</span><span class="n">func</span><span class="o">-</span><span class="n">regex</span><span class="o">=.</span> <span class="o">--</span><span class="n">shlib</span><span class="o">=</span><span class="n">libfoo</span><span class="o">.</span><span class="n">dylib</span>
<span class="n">Breakpoint</span> <span class="n">created</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="n">regex</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">module</span> <span class="o">=</span> <span class="n">libfoo</span><span class="o">.</span><span class="n">dylib</span><span class="p">,</span> <span class="n">locations</span> <span class="o">=</span> <span class="mi">223</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">script</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="nb">breakpoint</span> <span class="n">command</span> <span class="n">add</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="nb">type</span> <span class="n">python</span> <span class="mi">1</span>
<span class="n">Enter</span> <span class="n">your</span> <span class="n">Python</span> <span class="n">command</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Type</span> <span class="s1">&#39;DONE&#39;</span> <span class="n">to</span> <span class="n">end</span><span class="o">.</span>
<span class="o">&gt;</span> <span class="c1"># Increment our counter.  Since we are in a function, this must be a global python variable</span>
<span class="o">&gt;</span> <span class="k">global</span> <span class="n">counter</span>
<span class="o">&gt;</span> <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="o">&gt;</span> <span class="c1"># Get the name of the function</span>
<span class="o">&gt;</span> <span class="n">name</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetFunctionName</span><span class="p">()</span>
<span class="o">&gt;</span> <span class="c1"># Print the order and the function name</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="s1">&#39;[</span><span class="si">%i</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="c1"># Disable the current breakpoint location so it doesn&#39;t get hit again</span>
<span class="o">&gt;</span> <span class="n">bp_loc</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="c1"># No need to stop here</span>
<span class="o">&gt;</span> <span class="k">return</span> <span class="kc">False</span>
<span class="o">&gt;</span> <span class="n">DONE</span>
</pre></div>
</div>
<p>The breakpoint command add command above attaches a python script to breakpoint 1. To remove the breakpoint command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="nb">breakpoint</span> <span class="n">command</span> <span class="n">delete</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="using-the-python-api-s-to-create-custom-breakpoints">
<h2>Using the python api‚Äôs to create custom breakpoints<a class="headerlink" href="#using-the-python-api-s-to-create-custom-breakpoints" title="Permalink to this heading">#</a></h2>
<p>Another use of the Python API‚Äôs in lldb is to create a custom breakpoint
resolver. This facility was added in r342259.</p>
<p>It allows you to provide the algorithm which will be used in the breakpoint‚Äôs
search of the space of the code in a given Target to determine where to set the
breakpoint locations - the actual places where the breakpoint will trigger. To
understand how this works you need to know a little about how lldb handles
breakpoints.</p>
<p>In lldb, a breakpoint is composed of three parts: the Searcher, the Resolver,
and the Stop Options. The Searcher and Resolver cooperate to determine how
breakpoint locations are set and differ between each breakpoint type. Stop
options determine what happens when a location triggers and includes the
commands, conditions, ignore counts, etc. Stop options are common between all
breakpoint types, so for our purposes only the Searcher and Resolver are
relevant.</p>
<p>The Searcher‚Äôs job is to traverse in a structured way the code in the current
target. It proceeds from the Target, to search all the Modules in the Target,
in each Module it can recurse into the Compile Units in that module, and within
each Compile Unit it can recurse over the Functions it contains.</p>
<p>The Searcher can be provided with a SearchFilter that it will use to restrict
this search. For instance, if the SearchFilter specifies a list of Modules, the
Searcher will not recurse into Modules that aren‚Äôt on the list. When you pass
the -s modulename flag to break set you are creating a Module-based search
filter. When you pass -f filename.c to break set -n you are creating a file
based search filter. If neither of these is specified, the breakpoint will have
a no-op search filter, so all parts of the program are searched and all
locations accepted.</p>
<p>The Resolver has two functions. The most important one is the callback it
provides. This will get called at the appropriate time in the course of the
search. The callback is where the job of adding locations to the breakpoint
gets done.</p>
<p>The other function is specifying to the Searcher at what depth in the above
described recursion it wants to be called. Setting a search depth also provides
a stop for the recursion. For instance, if you request a Module depth search,
then the callback will be called for each Module as it gets added to the
Target, but the searcher will not recurse into the Compile Units in the module.</p>
<p>One other slight subtlety is that the depth at which you get called back is not
necessarily the depth at which the SearchFilter is specified. For instance,
if you are doing symbol searches, it is convenient to use the Module depth for
the search, since symbols are stored in the module. But the SearchFilter might
specify some subset of CompileUnits, so not all the symbols you might find in
each module will pass the search. You don‚Äôt need to handle this situation
yourself, since SBBreakpoint::AddLocation will only add locations that pass the
Search Filter. This API returns an SBError to inform you whether your location
was added.</p>
<p>When the breakpoint is originally created, its Searcher will process all the
currently loaded modules. The Searcher will also visit any new modules as they
are added to the target. This happens, for instance, when a new shared library
gets added to the target in the course of running, or on rerunning if any of
the currently loaded modules have been changed. Note, in the latter case, all
the locations set in the old module will get deleted and you will be asked to
recreate them in the new version of the module when your callback gets called
with that module. For this reason, you shouldn‚Äôt try to manage the locations
you add to the breakpoint yourself. Note that the Breakpoint takes care of
deduplicating equal addresses in AddLocation, so you shouldn‚Äôt need to worry
about that anyway.</p>
<p>At present, when adding a scripted Breakpoint type, you can only provide a
custom Resolver, not a custom SearchFilter.</p>
<p>The custom Resolver is provided as a Python class with the following methods:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Arguments</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bkpt</span></code>:<a class="reference internal" href="../python_api/lldb.SBBreakpoint.html#lldb.SBBreakpoint" title="lldb.SBBreakpoint"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBBreakpoint</span></code></a>
<code class="docutils literal notranslate"><span class="pre">extra_args</span></code>:<a class="reference internal" href="../python_api/lldb.SBStructuredData.html#lldb.SBStructuredData" title="lldb.SBStructuredData"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBStructuredData</span></code></a></p></td>
<td><p>This is the constructor for the new Resolver.</p>
<p><code class="docutils literal notranslate"><span class="pre">bkpt</span></code> is the breakpoint owning this Resolver.</p>
<p><code class="docutils literal notranslate"><span class="pre">extra_args</span></code> is an <a class="reference internal" href="../python_api/lldb.SBStructuredData.html#lldb.SBStructuredData" title="lldb.SBStructuredData"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBStructuredData</span></code></a> object that the user can pass in when creating instances of this
breakpoint.  It is not required, but is quite handy.  For instance if you were implementing a breakpoint on some
symbol name, you could write a generic symbol name based Resolver, and then allow the user to pass
in the particular symbol in the extra_args</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__callback__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sym_ctx</span></code>:<a class="reference internal" href="../python_api/lldb.SBSymbolContext.html#lldb.SBSymbolContext" title="lldb.SBSymbolContext"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBSymbolContext</span></code></a></p></td>
<td><p>This is the Resolver callback.
The <code class="docutils literal notranslate"><span class="pre">sym_ctx</span></code> argument will be filled with the current stage
of the search.</p>
<p>For instance, if you asked for a search depth of lldb.eSearchDepthCompUnit, then the
target, module and compile_unit fields of the sym_ctx will be filled.  The callback should look just in the
context passed in <code class="docutils literal notranslate"><span class="pre">sym_ctx</span></code> for new locations.  If the callback finds an address of interest, it
can add it to the breakpoint with the <a class="reference internal" href="../python_api/lldb.SBBreakpoint.html#lldb.SBBreakpoint.AddLocation" title="lldb.SBBreakpoint.AddLocation"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">SBBreakpoint.AddLocation</span></code></a> method, using the breakpoint passed
in to the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__get_depth__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Specify the depth at which you wish your callback to get called.  The currently supported options are:</p>
<p><a class="reference internal" href="../python_api_enums.html#lldb.eSearchDepthModule" title="lldb.eSearchDepthModule"><code class="xref any py py-data docutils literal notranslate"><span class="pre">lldb.eSearchDepthModule</span></code></a>
<a class="reference internal" href="../python_api_enums.html#lldb.eSearchDepthCompUnit" title="lldb.eSearchDepthCompUnit"><code class="xref any py py-data docutils literal notranslate"><span class="pre">lldb.eSearchDepthCompUnit</span></code></a>
<a class="reference internal" href="../python_api_enums.html#lldb.eSearchDepthFunction" title="lldb.eSearchDepthFunction"><code class="xref any py py-data docutils literal notranslate"><span class="pre">lldb.eSearchDepthFunction</span></code></a></p>
<p>For instance, if you are looking
up symbols, which are stored at the Module level, you will want to get called back module by module.
So you would want to return <a class="reference internal" href="../python_api_enums.html#lldb.eSearchDepthModule" title="lldb.eSearchDepthModule"><code class="xref any py py-data docutils literal notranslate"><span class="pre">lldb.eSearchDepthModule</span></code></a>.  This method is optional.  If not provided the search
will be done at Module depth.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_short_help</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>This is an optional method.  If provided, the returned string will be printed at the beginning of
the description for this breakpoint.</p></td>
</tr>
</tbody>
</table>
</div>
<p>To define a new breakpoint command defined by this class from the lldb command
line, use the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="nb">breakpoint</span> <span class="nb">set</span> <span class="o">-</span><span class="n">P</span> <span class="n">MyModule</span><span class="o">.</span><span class="n">MyResolverClass</span>
</pre></div>
</div>
<p>You can also populate the extra_args SBStructuredData with a dictionary of
key/value pairs with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="nb">breakpoint</span> <span class="nb">set</span> <span class="o">-</span><span class="n">P</span> <span class="n">MyModule</span><span class="o">.</span><span class="n">MyResolverClass</span> <span class="o">-</span><span class="n">k</span> <span class="n">key_1</span> <span class="o">-</span><span class="n">v</span> <span class="n">value_1</span> <span class="o">-</span><span class="n">k</span> <span class="n">key_2</span> <span class="o">-</span><span class="n">v</span> <span class="n">value_2</span>
</pre></div>
</div>
<p>Although you can‚Äôt write a scripted SearchFilter, both the command line and the
SB API‚Äôs for adding a scripted resolver allow you to specify a SearchFilter
restricted to certain modules or certain compile units. When using the command
line to create the resolver, you can specify a Module specific SearchFilter by
passing the -s ModuleName option - which can be specified multiple times. You
can also specify a SearchFilter restricted to certain compile units by passing
in the -f CompUnitName option. This can also be specified more than once. And
you can mix the two to specify ‚Äúthis comp unit in this module‚Äù. So, for
instance,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="nb">breakpoint</span> <span class="nb">set</span> <span class="o">-</span><span class="n">P</span> <span class="n">MyModule</span><span class="o">.</span><span class="n">MyResolverClass</span> <span class="o">-</span><span class="n">s</span> <span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>will use your resolver, but will only recurse into or accept new locations in
the module a.out.</p>
<p>Another option for creating scripted breakpoints is to use the
SBTarget.CreateBreakpointFromScript API. This one has the advantage that you
can pass in an arbitrary SBStructuredData object, so you can create more
complex parametrizations. SBStructuredData has a handy SetFromJSON method which
you can use for this purpose. Your __init__ function gets passed this
SBStructuredData object. This API also allows you to directly provide the list
of Modules and the list of CompileUnits that will make up the SearchFilter. If
you pass in empty lists, the breakpoint will use the default ‚Äúsearch
everywhere,accept everything‚Äù filter.</p>
</section>
<section id="using-the-python-api-to-create-custom-stepping-logic">
<h2>Using the python API‚Äô to create custom stepping logic<a class="headerlink" href="#using-the-python-api-to-create-custom-stepping-logic" title="Permalink to this heading">#</a></h2>
<p>A slightly esoteric use of the Python API‚Äôs is to construct custom stepping
types. LLDB‚Äôs stepping is driven by a stack of ‚Äúthread plans‚Äù and a fairly
simple state machine that runs the plans. You can create a Python class that
works as a thread plan, and responds to the requests the state machine makes to
run its operations.</p>
<p>There is a longer discussion of scripted thread plans and the state machine,
and several interesting examples of their use in:</p>
<p><a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/examples/python/scripted_step.py">https://github.com/llvm/llvm-project/blob/main/lldb/examples/python/scripted_step.py</a></p>
<p>And for a MUCH fuller discussion of the whole state machine, see:</p>
<p><a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/include/lldb/Target/ThreadPlan.h">https://github.com/llvm/llvm-project/blob/main/lldb/include/lldb/Target/ThreadPlan.h</a></p>
<p>If you are reading those comments it is useful to know that scripted thread
plans are set to be ‚ÄúControllingPlans‚Äù, and not ‚ÄúOkayToDiscard‚Äù.</p>
<p>To implement a scripted step, you define a python class that has the following
methods:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Arguments</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">thread_plan</span></code>:<a class="reference internal" href="../python_api/lldb.SBThreadPlan.html#lldb.SBThreadPlan" title="lldb.SBThreadPlan"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBThreadPlan</span></code></a></p></td>
<td><p>This is the underlying <a class="reference internal" href="../python_api/lldb.SBThreadPlan.html#lldb.SBThreadPlan" title="lldb.SBThreadPlan"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SBThreadPlan</span></code></a> that is pushed onto the plan stack.
You will want to store this away in an ivar.  Also, if you are going to
use one of the canned thread plans, you can queue it at this point.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">explains_stop</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">event</span></code>: <a class="reference internal" href="../python_api/lldb.SBEvent.html#lldb.SBEvent" title="lldb.SBEvent"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBEvent</span></code></a></p></td>
<td><p>Return True if this stop is part of your thread plans logic, false otherwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">is_stale</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>If your plan is no longer relevant (for instance, you were
stepping in a particular stack frame, but some other operation
pushed that frame off the stack) return True and your plan will
get popped.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">should_step</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if you want lldb to instruction step one instruction,
or False to continue till the next breakpoint is hit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">should_stop</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">event</span></code>: <a class="reference internal" href="../python_api/lldb.SBEvent.html#lldb.SBEvent" title="lldb.SBEvent"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBEvent</span></code></a></p></td>
<td><p>If your plan wants to stop and return control to the user at this point, return True.
If your plan is done at this point, call SetPlanComplete on your
thread plan instance.
Also, do any work you need here to set up the next stage of stepping.</p></td>
</tr>
</tbody>
</table>
</div>
<p>To use this class to implement a step, use the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">thread</span> <span class="n">step</span><span class="o">-</span><span class="n">scripted</span> <span class="o">-</span><span class="n">C</span> <span class="n">MyModule</span><span class="o">.</span><span class="n">MyStepPlanClass</span>
</pre></div>
</div>
<p>Or use the SBThread.StepUsingScriptedThreadPlan API. The SBThreadPlan passed
into your __init__ function can also push several common plans (step
in/out/over and run-to-address) in front of itself on the stack, which can be
used to compose more complex stepping operations. When you use subsidiary plans
your explains_stop and should_stop methods won‚Äôt get called until the
subsidiary plan is done, or the process stops for an event the subsidiary plan
doesn‚Äôt explain. For instance, step over plans don‚Äôt explain a breakpoint hit
while performing the step-over.</p>
</section>
<section id="create-a-new-lldb-command-using-a-python-function">
<h2>Create a new lldb command using a Python function<a class="headerlink" href="#create-a-new-lldb-command-using-a-python-function" title="Permalink to this heading">#</a></h2>
<p>Python functions can be used to create new LLDB command interpreter commands,
which will work like all the natively defined lldb commands. This provides a
very flexible and easy way to extend LLDB to meet your debugging requirements.</p>
<p>To write a python function that implements a new LLDB command define the
function to take four arguments as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">command_function</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="c1"># Your code goes here</span>
</pre></div>
</div>
<p>Optionally, you can also provide a Python docstring, and LLDB will use it when providing help for your command, as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">command_function</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This command takes a lot of options and does many fancy things&quot;&quot;&quot;</span>
    <span class="c1"># Your code goes here</span>
</pre></div>
</div>
<p>Since lldb 3.5.2, LLDB Python commands can also take an SBExecutionContext as an
argument. This is useful in cases where the command‚Äôs notion of where to act is
independent of the currently-selected entities in the debugger.</p>
<p>This feature is enabled if the command-implementing function can be recognized
as taking 5 arguments, or a variable number of arguments, and it alters the
signature as such:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">command_function</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">exe_ctx</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="c1"># Your code goes here</span>
</pre></div>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Argument</p></td>
<td><p>Type</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">debugger</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBDebugger.html#lldb.SBDebugger" title="lldb.SBDebugger"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBDebugger</span></code></a></p></td>
<td><p>The current debugger object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">command</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">string</span></code></p></td>
<td><p>A python string containing all arguments for your command. If you need to chop up the arguments
try using the <code class="docutils literal notranslate"><span class="pre">shlex</span></code> module‚Äôs <code class="docutils literal notranslate"><span class="pre">shlex.split(command)</span></code> to properly extract the
arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exe_ctx</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBExecutionContext.html#lldb.SBExecutionContext" title="lldb.SBExecutionContext"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBExecutionContext</span></code></a></p></td>
<td><p>An execution context object carrying around information on the inferior process‚Äô context in which the command is expected to act</p>
<p><em>Optional since lldb 3.5.2, unavailable before</em></p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p><a class="reference internal" href="../python_api/lldb.SBCommandReturnObject.html#lldb.SBCommandReturnObject" title="lldb.SBCommandReturnObject"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lldb.SBCommandReturnObject</span></code></a></p></td>
<td><p>A return object which encapsulates success/failure information for the command and output text
that needs to be printed as a result of the command. The plain Python ‚Äúprint‚Äù command also works but
text won‚Äôt go in the result by default (it is useful as a temporary logging facility).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">internal_dict</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">dict</span> <span class="pre">object</span></code></p></td>
<td><p>The dictionary for the current embedded script session which contains all variables
and functions.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Since lldb 3.7, Python commands can also be implemented by means of a class
which should implement the following interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CommandObjectType</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debugger</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
        <span class="n">this</span> <span class="n">call</span> <span class="n">should</span> <span class="n">initialize</span> <span class="n">the</span> <span class="n">command</span> <span class="k">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">command</span> <span class="n">interpreter</span> <span class="k">for</span> <span class="n">the</span> <span class="n">passed</span><span class="o">-</span><span class="ow">in</span> <span class="n">debugger</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">exe_ctx</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="n">this</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">bulk</span> <span class="n">of</span> <span class="n">the</span> <span class="n">command</span><span class="p">,</span> <span class="n">akin</span> <span class="n">to</span> <span class="n">Python</span> <span class="n">command</span> <span class="n">functions</span>
    <span class="k">def</span> <span class="nf">get_short_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">this</span> <span class="n">call</span> <span class="n">should</span> <span class="k">return</span> <span class="n">the</span> <span class="n">short</span> <span class="n">help</span> <span class="n">text</span> <span class="k">for</span> <span class="n">this</span> <span class="n">command</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">get_long_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">this</span> <span class="n">call</span> <span class="n">should</span> <span class="k">return</span> <span class="n">the</span> <span class="n">long</span> <span class="n">help</span> <span class="n">text</span> <span class="k">for</span> <span class="n">this</span> <span class="n">command</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>[1] This method is optional.</p>
<p>As a convenience, you can treat the result object as a Python file object, and
say</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="o">&gt;&gt;</span><span class="n">result</span><span class="p">,</span> <span class="s2">&quot;my command does lots of cool stuff&quot;</span>
</pre></div>
</div>
<p>SBCommandReturnObject and SBStream both support this file-like behavior by
providing write() and flush() calls at the Python layer.</p>
<p>One other handy convenience when defining lldb command-line commands is the
command command script import which will import a module specified by file
path, so you don‚Äôt have to change your PYTHONPATH for temporary scripts. It
also has another convenience that if your new script module has a function of
the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">__lldb_init_module</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="c1"># Command Initialization code goes here</span>
</pre></div>
</div>
<p>where debugger and internal_dict are as above, that function will get run when
the module is loaded allowing you to add whatever commands you want into the
current debugger. Note that this function will only be run when using the LLDB
command <code class="docutils literal notranslate"><span class="pre">command</span> <span class="pre">script</span> <span class="pre">import</span></code>, it will not get run if anyone imports your
module from another module.</p>
<p>The standard test for <code class="docutils literal notranslate"><span class="pre">__main__</span></code>, like many python modules do, is useful for
creating scripts that can be run from the command line. However, for command
line scripts, the debugger instance must be created manually. Sample code would
look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Initialize the debugger before making any API calls.</span>
    <span class="n">lldb</span><span class="o">.</span><span class="n">SBDebugger</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>
    <span class="c1"># Create a new debugger instance in your module if your module</span>
    <span class="c1"># can be run from the command line. When we run a script from</span>
    <span class="c1"># the command line, we won&#39;t have any debugger object in</span>
    <span class="c1"># lldb.debugger, so we can just create it if it will be needed</span>
    <span class="n">debugger</span> <span class="o">=</span> <span class="n">lldb</span><span class="o">.</span><span class="n">SBDebugger</span><span class="o">.</span><span class="n">Create</span><span class="p">()</span>

    <span class="c1"># Next, do whatever work this module should do when run as a command.</span>
    <span class="c1"># ...</span>

    <span class="c1"># Finally, dispose of the debugger you just made.</span>
    <span class="n">lldb</span><span class="o">.</span><span class="n">SBDebugger</span><span class="o">.</span><span class="n">Destroy</span><span class="p">(</span><span class="n">debugger</span><span class="p">)</span>
    <span class="c1"># Terminate the debug session</span>
    <span class="n">lldb</span><span class="o">.</span><span class="n">SBDebugger</span><span class="o">.</span><span class="n">Terminate</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we can create a module called ls.py in the file ~/ls.py that will implement
a function that can be used by LLDB‚Äôs python command code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">lldb</span>
<span class="kn">import</span> <span class="nn">commands</span>
<span class="kn">import</span> <span class="nn">optparse</span>
<span class="kn">import</span> <span class="nn">shlex</span>

<span class="k">def</span> <span class="nf">ls</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="nb">print</span> <span class="o">&gt;&gt;</span><span class="n">result</span><span class="p">,</span> <span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">getoutput</span><span class="p">(</span><span class="s1">&#39;/bin/ls </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">command</span><span class="p">))</span>

<span class="c1"># And the initialization code to add your commands</span>
<span class="k">def</span> <span class="nf">__lldb_init_module</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">HandleCommand</span><span class="p">(</span><span class="s1">&#39;command script add -f ls.ls ls&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;The &quot;ls&quot; python command has been installed and is ready for use.&#39;</span>
</pre></div>
</div>
<p>Now we can load the module into LLDB and use it</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ lldb
(lldb) command script import ~/ls.py
The &quot;ls&quot; python command has been installed and is ready for use.
(lldb) ls -l /tmp/
total 365848
-rw-r--r--@  1 someuser  wheel         6148 Jan 19 17:27 .DS_Store
-rw-------   1 someuser  wheel         7331 Jan 19 15:37 crash.log
</pre></div>
</div>
<p>You can also make ‚Äúcontainer‚Äù commands to organize the commands you are adding to
lldb.  Most of the lldb built-in commands structure themselves this way, and using
a tree structure has the benefit of leaving the one-word command space free for user
aliases.  It can also make it easier to find commands if you are adding more than
a few of them.  Here‚Äôs a trivial example of adding two ‚Äúutility‚Äù commands into a
‚Äúmy-utilities‚Äù container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">lldb</span>

<span class="k">def</span> <span class="nf">first_utility</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am the first utility&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">second_utility</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am the second utility&quot;</span><span class="p">)</span>

<span class="c1"># And the initialization code to add your commands</span>
<span class="k">def</span> <span class="nf">__lldb_init_module</span><span class="p">(</span><span class="n">debugger</span><span class="p">,</span> <span class="n">internal_dict</span><span class="p">):</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">HandleCommand</span><span class="p">(</span><span class="s1">&#39;command container add -h &quot;A container for my utilities&quot; my-utilities&#39;</span><span class="p">)</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">HandleCommand</span><span class="p">(</span><span class="s1">&#39;command script add -f my_utilities.first_utility -h &quot;My first utility&quot; my-utilities first&#39;</span><span class="p">)</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">HandleCommand</span><span class="p">(</span><span class="s1">&#39;command script add -f my_utilities.second_utility -h &quot;My second utility&quot; my-utilities second&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The &quot;my-utilities&quot; python command has been installed and its subcommands are ready for use.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then your new commands are available under the my-utilities node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">help</span> <span class="n">my</span><span class="o">-</span><span class="n">utilities</span>
<span class="n">A</span> <span class="n">container</span> <span class="k">for</span> <span class="n">my</span> <span class="n">utilities</span>

<span class="n">Syntax</span><span class="p">:</span> <span class="n">my</span><span class="o">-</span><span class="n">utilities</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">subcommands</span> <span class="n">are</span> <span class="n">supported</span><span class="p">:</span>

    <span class="n">first</span>  <span class="o">--</span> <span class="n">My</span> <span class="n">first</span> <span class="n">utility</span>  <span class="n">Expects</span> <span class="s1">&#39;raw&#39;</span> <span class="nb">input</span> <span class="p">(</span><span class="n">see</span> <span class="s1">&#39;help raw-input&#39;</span><span class="o">.</span><span class="p">)</span>
    <span class="n">second</span> <span class="o">--</span> <span class="n">My</span> <span class="n">second</span> <span class="n">utility</span>  <span class="n">Expects</span> <span class="s1">&#39;raw&#39;</span> <span class="nb">input</span> <span class="p">(</span><span class="n">see</span> <span class="s1">&#39;help raw-input&#39;</span><span class="o">.</span><span class="p">)</span>

<span class="n">For</span> <span class="n">more</span> <span class="n">help</span> <span class="n">on</span> <span class="nb">any</span> <span class="n">particular</span> <span class="n">subcommand</span><span class="p">,</span> <span class="nb">type</span> <span class="s1">&#39;help &lt;command&gt; &lt;subcommand&gt;&#39;</span><span class="o">.</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">my</span><span class="o">-</span><span class="n">utilities</span> <span class="n">first</span>
<span class="n">I</span> <span class="n">am</span> <span class="n">the</span> <span class="n">first</span> <span class="n">utility</span>
</pre></div>
</div>
<p>A more interesting template has been created in the source repository that can
help you to create lldb command quickly:</p>
<p><a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/examples/python/cmdtemplate.py">https://github.com/llvm/llvm-project/blob/main/lldb/examples/python/cmdtemplate.py</a></p>
<p>A commonly required facility is being able to create a command that does some
token substitution, and then runs a different debugger command (usually, it
po‚Äôes the result of an expression evaluated on its argument). For instance,
given the following program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#import &lt;Foundation/Foundation.h&gt;</span>
<span class="n">NSString</span><span class="o">*</span>
<span class="n">ModifyString</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span> <span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">src</span> <span class="n">stringByAppendingString</span><span class="p">:</span><span class="o">@</span><span class="s2">&quot;foobar&quot;</span><span class="p">];</span>
<span class="p">}</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
      <span class="n">NSString</span><span class="o">*</span> <span class="n">aString</span> <span class="o">=</span> <span class="o">@</span><span class="s2">&quot;Hello world&quot;</span><span class="p">;</span>
      <span class="n">NSString</span><span class="o">*</span> <span class="n">anotherString</span> <span class="o">=</span> <span class="o">@</span><span class="s2">&quot;Let&#39;s be friends&quot;</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>you may want a pofoo X command, that equates po [ModifyString(X)
capitalizedString]. The following debugger interaction shows how to achieve
that goal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(lldb) script
Python Interactive Interpreter. To exit, type &#39;quit()&#39;, &#39;exit()&#39; or Ctrl-D.
&gt;&gt;&gt; def pofoo_funct(debugger, command, result, internal_dict):
...   cmd = &quot;po [ModifyString(&quot; + command + &quot;) capitalizedString]&quot;
...   debugger.HandleCommand(cmd)
...
&gt;&gt;&gt; ^D
(lldb) command script add pofoo -f pofoo_funct
(lldb) pofoo aString
$1 = 0x000000010010aa00 Hello Worldfoobar
(lldb) pofoo anotherString
$2 = 0x000000010010aba0 Let&#39;s Be Friendsfoobar
</pre></div>
</div>
</section>
<section id="using-the-lldb-py-module-in-python">
<h2>Using the lldb.py module in Python<a class="headerlink" href="#using-the-lldb-py-module-in-python" title="Permalink to this heading">#</a></h2>
<p>LLDB has all of its core code build into a shared library which gets used by
the <a class="reference internal" href="../python_api.html#module-lldb" title="lldb"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">lldb</span></code></a> command line application. On macOS this shared library is a
framework: LLDB.framework and on other unix variants the program is a shared
library: lldb.so. LLDB also provides an lldb.py module that contains the
bindings from LLDB into Python. To use the LLDB.framework to create your own
stand-alone python programs, you will need to tell python where to look in
order to find this module. This is done by setting the PYTHONPATH environment
variable, adding a path to the directory that contains the lldb.py python
module. The lldb driver program has an option to report the path to the lldb
module. You can use that to point to correct lldb.py:</p>
<p>For csh and tcsh:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% setenv PYTHONPATH `lldb -P`
</pre></div>
</div>
<p>For sh and bash:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export PYTHONPATH=`lldb -P`
</pre></div>
</div>
<p>Alternately, you can append the LLDB Python directory to the sys.path list
directly in your Python code before importing the lldb module.</p>
<p>Now your python scripts are ready to import the lldb module. Below is a python
script that will launch a program from the current working directory called
‚Äúa.out‚Äù, set a breakpoint at ‚Äúmain‚Äù, and then run and hit the breakpoint, and
print the process, thread and frame objects if the process stopped:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">lldb</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">disassemble_instructions</span><span class="p">(</span><span class="n">insts</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">insts</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">i</span>

<span class="c1"># Set the path to the executable to debug</span>
<span class="n">exe</span> <span class="o">=</span> <span class="s2">&quot;./a.out&quot;</span>

<span class="c1"># Create a new debugger instance</span>
<span class="n">debugger</span> <span class="o">=</span> <span class="n">lldb</span><span class="o">.</span><span class="n">SBDebugger</span><span class="o">.</span><span class="n">Create</span><span class="p">()</span>

<span class="c1"># When we step or continue, don&#39;t return from the function until the process</span>
<span class="c1"># stops. Otherwise we would have to handle the process events ourselves which, while doable is</span>
<span class="c1">#a little tricky.  We do this by setting the async mode to false.</span>
<span class="n">debugger</span><span class="o">.</span><span class="n">SetAsync</span> <span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Create a target from a file and arch</span>
<span class="nb">print</span> <span class="s2">&quot;Creating a target for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">exe</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">debugger</span><span class="o">.</span><span class="n">CreateTargetWithFileAndArch</span> <span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">lldb</span><span class="o">.</span><span class="n">LLDB_ARCH_DEFAULT</span><span class="p">)</span>

<span class="k">if</span> <span class="n">target</span><span class="p">:</span>
    <span class="c1"># If the target is valid set a breakpoint at main</span>
    <span class="n">main_bp</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">BreakpointCreateByName</span> <span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">GetExecutable</span><span class="p">()</span><span class="o">.</span><span class="n">GetFilename</span><span class="p">());</span>

    <span class="nb">print</span> <span class="n">main_bp</span>

    <span class="c1"># Launch the process. Since we specified synchronous mode, we won&#39;t return</span>
    <span class="c1"># from this function until we hit the breakpoint at main</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">LaunchSimple</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

    <span class="c1"># Make sure the launch went ok</span>
    <span class="k">if</span> <span class="n">process</span><span class="p">:</span>
        <span class="c1"># Print some simple process info</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">GetState</span> <span class="p">()</span>
        <span class="nb">print</span> <span class="n">process</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">lldb</span><span class="o">.</span><span class="n">eStateStopped</span><span class="p">:</span>
            <span class="c1"># Get the first thread</span>
            <span class="n">thread</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">GetThreadAtIndex</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">thread</span><span class="p">:</span>
                <span class="c1"># Print some simple thread info</span>
                <span class="nb">print</span> <span class="n">thread</span>
                <span class="c1"># Get the first frame</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="n">thread</span><span class="o">.</span><span class="n">GetFrameAtIndex</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">frame</span><span class="p">:</span>
                    <span class="c1"># Print some simple frame info</span>
                    <span class="nb">print</span> <span class="n">frame</span>
                    <span class="n">function</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetFunction</span><span class="p">()</span>
                    <span class="c1"># See if we have debug info (a function)</span>
                    <span class="k">if</span> <span class="n">function</span><span class="p">:</span>
                        <span class="c1"># We do have a function, print some info for the function</span>
                        <span class="nb">print</span> <span class="n">function</span>
                        <span class="c1"># Now get all instructions for this function and print them</span>
                        <span class="n">insts</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="n">GetInstructions</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                        <span class="n">disassemble_instructions</span> <span class="p">(</span><span class="n">insts</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># See if we have a symbol in the symbol table for where we stopped</span>
                        <span class="n">symbol</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">();</span>
                        <span class="k">if</span> <span class="n">symbol</span><span class="p">:</span>
                            <span class="c1"># We do have a symbol, print some info for the symbol</span>
                            <span class="nb">print</span> <span class="n">symbol</span>
</pre></div>
</div>
</section>
<section id="writing-lldb-frame-recognizers-in-python">
<h2>Writing lldb frame recognizers in Python<a class="headerlink" href="#writing-lldb-frame-recognizers-in-python" title="Permalink to this heading">#</a></h2>
<p>Frame recognizers allow for retrieving information about special frames based
on ABI, arguments or other special properties of that frame, even without
source code or debug info. Currently, one use case is to extract function
arguments that would otherwise be inaccessible, or augment existing arguments.</p>
<p>Adding a custom frame recognizer is done by implementing a Python class and
using the ‚Äòframe recognizer add‚Äô command. The Python class should have a
‚Äòget_recognized_arguments‚Äô method and it will receive an argument of type
lldb.SBFrame representing the current frame that we are trying to recognize.
The method should return a (possibly empty) list of lldb.SBValue objects that
represent the recognized arguments.</p>
<p>An example of a recognizer that retrieves the file descriptor values from libc
functions ‚Äòread‚Äô, ‚Äòwrite‚Äô and ‚Äòclose‚Äô follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LibcFdRecognizer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">get_recognized_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]:</span>
      <span class="n">fd</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">EvaluateExpression</span><span class="p">(</span><span class="s2">&quot;$arg1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unsigned</span>
      <span class="n">target</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">target</span>
      <span class="n">value</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">CreateValueFromExpression</span><span class="p">(</span><span class="s2">&quot;fd&quot;</span><span class="p">,</span> <span class="s2">&quot;(int)</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fd</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>
</div>
<p>The file containing this implementation can be imported via <code class="docutils literal notranslate"><span class="pre">command</span> <span class="pre">script</span> <span class="pre">import</span></code>
and then we can register this recognizer with <code class="docutils literal notranslate"><span class="pre">frame</span> <span class="pre">recognizer</span> <span class="pre">add</span></code>.
It‚Äôs important to restrict the recognizer to the libc library (which is
libsystem_kernel.dylib on macOS) to avoid matching functions with the same name
in other modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">command</span> <span class="n">script</span> <span class="kn">import</span> <span class="nn">...</span><span class="o">/</span><span class="n">fd_recognizer</span><span class="o">.</span><span class="n">py</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">frame</span> <span class="n">recognizer</span> <span class="n">add</span> <span class="o">-</span><span class="n">l</span> <span class="n">fd_recognizer</span><span class="o">.</span><span class="n">LibcFdRecognizer</span> <span class="o">-</span><span class="n">n</span> <span class="n">read</span> <span class="o">-</span><span class="n">s</span> <span class="n">libsystem_kernel</span><span class="o">.</span><span class="n">dylib</span>
</pre></div>
</div>
<p>When the program is stopped at the beginning of the ‚Äòread‚Äô function in libc, we can view the recognizer arguments in ‚Äòframe variable‚Äô:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">b</span> <span class="n">read</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">r</span>
<span class="n">Process</span> <span class="mi">1234</span> <span class="n">stopped</span>
<span class="o">*</span> <span class="n">thread</span> <span class="c1">#1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 1.3</span>
    <span class="n">frame</span> <span class="c1">#0: 0x00007fff06013ca0 libsystem_kernel.dylib`read</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">frame</span> <span class="n">variable</span>
<span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="n">fd</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</section>
<section id="writing-target-stop-hooks-in-python">
<h2>Writing Target Stop-Hooks in Python:<a class="headerlink" href="#writing-target-stop-hooks-in-python" title="Permalink to this heading">#</a></h2>
<p>Stop hooks fire whenever the process stops just before control is returned to the
user.  Stop hooks can either be a set of lldb command-line commands, or can
be implemented by a suitably defined Python class.  The Python based stop-hooks
can also be passed as set of -key -value pairs when they are added, and those
will get packaged up into a SBStructuredData Dictionary and passed to the
constructor of the Python object managing the stop hook.  This allows for
parametrization of the stop hooks.</p>
<p>To add a Python-based stop hook, first define a class with the following methods:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Arguments</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">target:</span> <span class="pre">lldb.SBTarget</span></code>
<code class="docutils literal notranslate"><span class="pre">extra_args:</span> <span class="pre">lldb.SBStructuredData</span></code></p></td>
<td><p>This is the constructor for the new stop-hook.</p>
<p><code class="docutils literal notranslate"><span class="pre">target</span></code> is the SBTarget to which the stop hook is added.</p>
<p><code class="docutils literal notranslate"><span class="pre">extra_args</span></code> is an SBStructuredData object that the user can pass in when creating instances of this
breakpoint.  It is not required, but allows for reuse of stop-hook classes.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">handle_stop</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exe_ctx:</span> <span class="pre">lldb.SBExecutionContext</span></code>
<code class="docutils literal notranslate"><span class="pre">stream:</span> <span class="pre">lldb.SBStream</span></code></p></td>
<td><p>This is the called when the target stops.</p>
<p><code class="docutils literal notranslate"><span class="pre">exe_ctx</span></code> argument will be filled with the current stop point for which the stop hook is
being evaluated.</p>
<p><code class="docutils literal notranslate"><span class="pre">stream</span></code> an lldb.SBStream, anything written to this stream will be written to the debugger console.</p>
<p>The return value is a ‚ÄúShould Stop‚Äù vote from this thread.  If the method returns either True or no return
this thread votes to stop.  If it returns False, then the thread votes to continue after all the stop-hooks
are evaluated.
Note, the ‚Äìauto-continue flag to ‚Äòtarget stop-hook add‚Äô overrides a True return value from the method.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>To use this class in lldb, run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">command</span> <span class="n">script</span> <span class="kn">import</span> <span class="nn">MyModule.py</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span> <span class="n">target</span> <span class="n">stop</span><span class="o">-</span><span class="n">hook</span> <span class="n">add</span> <span class="o">-</span><span class="n">P</span> <span class="n">MyModule</span><span class="o">.</span><span class="n">MyStopHook</span> <span class="o">-</span><span class="n">k</span> <span class="n">first</span> <span class="o">-</span><span class="n">v</span> <span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">second</span> <span class="o">-</span><span class="n">v</span> <span class="mi">2</span>
</pre></div>
</div>
<p>where MyModule.py is the file containing the class definition MyStopHook.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../python_api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">LLDB Python API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="python.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Python Scripting</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2007-2023, The LLDB Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Aug 18, 2023</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Python Reference</a><ul>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#embedded-python-interpreter">Embedded Python Interpreter</a></li>
<li><a class="reference internal" href="#running-a-python-script-when-a-breakpoint-gets-hit">Running a python script when a breakpoint gets hit</a></li>
<li><a class="reference internal" href="#using-the-python-api-s-to-create-custom-breakpoints">Using the python api‚Äôs to create custom breakpoints</a></li>
<li><a class="reference internal" href="#using-the-python-api-to-create-custom-stepping-logic">Using the python API‚Äô to create custom stepping logic</a></li>
<li><a class="reference internal" href="#create-a-new-lldb-command-using-a-python-function">Create a new lldb command using a Python function</a></li>
<li><a class="reference internal" href="#using-the-lldb-py-module-in-python">Using the lldb.py module in Python</a></li>
<li><a class="reference internal" href="#writing-lldb-frame-recognizers-in-python">Writing lldb frame recognizers in Python</a></li>
<li><a class="reference internal" href="#writing-target-stop-hooks-in-python">Writing Target Stop-Hooks in Python:</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=033e7e97"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>